---
title: "multivariate analysis"
output: html_document
---


```{r}

## Mulitvariate Cox's regression model tables

library(survminer)
library("survival")
library(MASS)
library(data.table)
library(dplyr)
dim(cohort)
dim(combi15)
dim(combi18)

cohort<-nano_data[-132,] 

combi15$patient<-rownames(combi_score)
cohort$patient<-rownames(cohort)

cohort<-inner_join(cohort, combi15, by="patient")

cohort<-cohort[,-(73:92)]
cohort<-cohort[,-(75:76)]

combi18$patient<-rownames(combi_score)

cohort<-inner_join(cohort, combi18, by="patient")
cohort<-cohort[,-(76:77)]
rownames(cohort)<-cohort$patient
cohort<-cohort[,-c(1,2,73)]
colnames(cohort)[3]<-paste("RFS")
colnames(cohort)[4]<-paste("RFS01")

#multivariable COX regression

genes <- c("Age", "Sex", "Grade", "T", "combi18_score")
cutoff <- surv_cutpoint(cohort, time = "RFS", event = "RFS01", variables = genes, minprop = 0.1, progressbar = TRUE)
surv_cat <- surv_categorize(cutoff)

res.cox <- coxph(Surv(RFS, RFS01) ~ combi18_score + Age + Sex + Grade + T, data = surv_cat)

summary(res.cox)



genes <- c("Age", "Sex", "Grade", "T", "combi15_score")
cutoff <- surv_cutpoint(cohort, time = "RFS", event = "RFS01", variables = genes, minprop = 0.1, progressbar = TRUE)
surv_cat <- surv_categorize(cutoff)

res.cox <- coxph(Surv(RFS, RFS01) ~ combi15_score + Age + Sex + Grade + T ,data = surv_cat)

res.cox
sum<-summary(res.cox)
sum$conf.int

```

